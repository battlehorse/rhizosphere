<project name="RhizoSphereGwt" default="pack" basedir="../">
	<loadproperties srcfile="build/build.properties" />

	<property name="ant-work-dir" value="." />
	<property name="gwt-sdk" value="."/>
	<property name="gwt-visualization-jar" value="gwt-visualization.jar"/>

	<property name="compile-output-dir" value="${ant-work-dir}/classes" />
	<property name="exploded-output-dir" value="${ant-work-dir}/exploded" />
	<property name="packages-output-dir" value="${ant-work-dir}/packages" />

	<path id="classpath.compile">
		<pathelement location="${compile-output-dir}"/>
		<pathelement location="${gwt-sdk}/gwt-user.jar"/>
		<pathelement location="${gwt-sdk}/gwt-dev.jar"/>
		<pathelement location="${gwt-visualization-jar}"/>
	</path>

	<target name="clean">
		<delete dir="${ant-work-dir}">
		</delete>
	</target>

	<target name="prepare-output-folders" depends="clean">
		<mkdir dir="${compile-output-dir}" />
		<mkdir dir="${exploded-output-dir}" />
		<mkdir dir="${packages-output-dir}" />
	</target>

	<target name="compile" depends="prepare-output-folders">
		<javac srcdir="src" destdir="${compile-output-dir}" source="5" target="5" encoding="Cp1252"
			debug="true" verbose="true">
			<classpath refid="classpath.compile" />
		</javac>
	</target>

	<target name="explode" depends="compile">
		<!-- copy XML descriptor and java source files -->
		<copy todir="${exploded-output-dir}" failonerror="true">
			<fileset dir="src"></fileset>
		</copy>
		<!-- copy classes -->
		<copy todir="${exploded-output-dir}">
			<fileset dir="${compile-output-dir}"></fileset>
		</copy>
	</target>

	<target name="pack" depends="explode">
		<jar file="${packages-output-dir}/gwt-rhizosphere.jar">
			<fileset dir="${exploded-output-dir}"></fileset>
		</jar>
	</target>
</project>